---
// Floating music notes and Christmas snow particle effect
---

<div id="music-particles" class="music-particles" aria-hidden="true"></div>
<div id="snow-particles" class="snow-particles" aria-hidden="true"></div>

<style>
  .music-particles, .snow-particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
  }

  .snow-particles {
    z-index: 2;
  }

  .music-note {
    position: absolute;
    font-size: 1.5rem;
    color: rgba(212, 175, 55, 0.15);
    animation: floatUp linear infinite;
    pointer-events: none;
    user-select: none;
  }

  @keyframes floatUp {
    0% {
      transform: translateY(100vh) rotate(0deg) scale(0.5);
      opacity: 0;
    }
    10% {
      opacity: 1;
    }
    90% {
      opacity: 1;
    }
    100% {
      transform: translateY(-10vh) rotate(360deg) scale(1);
      opacity: 0;
    }
  }

  .music-note:nth-child(even) {
    animation-timing-function: ease-in-out;
  }

  .music-note.glow {
    text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
  }

  /* Christmas Snow */
  .snowflake {
    position: absolute;
    color: rgba(255, 255, 255, 0.8);
    font-size: 1rem;
    animation: snowfall linear infinite;
    pointer-events: none;
    user-select: none;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
  }

  @keyframes snowfall {
    0% {
      transform: translateY(-10vh) translateX(0) rotate(0deg);
      opacity: 0;
    }
    5% {
      opacity: 1;
    }
    95% {
      opacity: 1;
    }
    100% {
      transform: translateY(105vh) translateX(var(--drift, 20px)) rotate(360deg);
      opacity: 0;
    }
  }

  /* Gentle swaying for some snowflakes */
  .snowflake.sway {
    animation: snowfallSway linear infinite;
  }

  @keyframes snowfallSway {
    0% {
      transform: translateY(-10vh) translateX(0) rotate(0deg);
      opacity: 0;
    }
    5% {
      opacity: 1;
    }
    25% {
      transform: translateY(20vh) translateX(15px) rotate(90deg);
    }
    50% {
      transform: translateY(50vh) translateX(-10px) rotate(180deg);
    }
    75% {
      transform: translateY(75vh) translateX(20px) rotate(270deg);
    }
    95% {
      opacity: 1;
    }
    100% {
      transform: translateY(105vh) translateX(5px) rotate(360deg);
      opacity: 0;
    }
  }

  /* Christmas glow on gold elements */
  .christmas-glow {
    animation: christmasGlow 3s ease-in-out infinite alternate;
  }

  @keyframes christmasGlow {
    0% {
      filter: drop-shadow(0 0 5px rgba(212, 175, 55, 0.3));
    }
    100% {
      filter: drop-shadow(0 0 15px rgba(212, 175, 55, 0.6));
    }
  }
</style>

<script>
  const particles = document.getElementById('music-particles');
  const snowContainer = document.getElementById('snow-particles');
  const notes = ['â™ª', 'â™«', 'â™¬', 'â™©', 'ð„ž', 'ð„¢'];
  const snowflakes = ['â„', 'â…', 'â†', 'âœ»', 'âœ¼', 'â‹'];

  // Check if it's December (Christmas season)
  const isChristmasSeason = new Date().getMonth() === 11; // December = 11

  function createNote() {
    const note = document.createElement('span');
    note.className = 'music-note';
    note.textContent = notes[Math.floor(Math.random() * notes.length)];
    note.style.left = Math.random() * 100 + 'vw';
    note.style.animationDuration = (15 + Math.random() * 20) + 's';
    note.style.animationDelay = Math.random() * 5 + 's';
    note.style.fontSize = (0.8 + Math.random() * 1.2) + 'rem';
    note.style.opacity = (0.05 + Math.random() * 0.15).toString();

    if (Math.random() > 0.7) {
      note.classList.add('glow');
    }

    particles?.appendChild(note);

    setTimeout(() => {
      note.remove();
    }, 35000);
  }

  function createSnowflake() {
    if (!snowContainer) return;

    const flake = document.createElement('span');
    flake.className = 'snowflake';

    // Mix of snowflakes and small dots for variety
    if (Math.random() > 0.3) {
      flake.textContent = snowflakes[Math.floor(Math.random() * snowflakes.length)];
    } else {
      flake.textContent = 'â€¢';
      flake.style.fontSize = (0.3 + Math.random() * 0.5) + 'rem';
    }

    flake.style.left = Math.random() * 100 + 'vw';
    flake.style.animationDuration = (8 + Math.random() * 12) + 's';
    flake.style.animationDelay = Math.random() * 2 + 's';
    flake.style.fontSize = (0.5 + Math.random() * 1) + 'rem';
    flake.style.opacity = (0.4 + Math.random() * 0.5).toString();
    flake.style.setProperty('--drift', (Math.random() * 40 - 20) + 'px');

    // Some snowflakes sway
    if (Math.random() > 0.6) {
      flake.classList.add('sway');
    }

    snowContainer.appendChild(flake);

    setTimeout(() => {
      flake.remove();
    }, 25000);
  }

  // Create initial notes
  for (let i = 0; i < 15; i++) {
    setTimeout(createNote, i * 500);
  }

  // Continuously create new notes
  setInterval(createNote, 2000);

  // Christmas snow - always show for the gift!
  // Create initial snowflakes
  for (let i = 0; i < 30; i++) {
    setTimeout(createSnowflake, i * 100);
  }

  // Continuously create snowflakes
  setInterval(createSnowflake, 400);

  // Reduce particles when piano is open (performance)
  const pianoContainer = document.getElementById('piano-container');
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.attributeName === 'class') {
        const isVisible = pianoContainer?.classList.contains('visible');
        if (particles) particles.style.opacity = isVisible ? '0.3' : '1';
        if (snowContainer) snowContainer.style.opacity = isVisible ? '0.5' : '1';
      }
    });
  });

  if (pianoContainer) {
    observer.observe(pianoContainer, { attributes: true });
  }
</script>
